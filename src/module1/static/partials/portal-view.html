<md-toolbar layout="row" layout-padding layout-align="space-around center" md-scroll-shrink>
    <div flex="66" layout-align="start center">
      <portal-title portal-info="portal"></portal-title>
    </div>
    <div flex="33" layout="row" layout-align="end center">
      <md-switch hide-sm hide-md ng-model="sys_config.allow_sidebar_right_locked_open" aria-label="Fijar">
        <span hide>Fijar: {{ sys_config.allow_sidebar_right_locked_open }}</span>
      </md-switch>
      <md-button ng-click="closeRight()" class="md-fab md-accent md-closing-button-x"><span>X</span></md-button>
    </div>
</md-toolbar>
<md-content flex layout="column" layout-align="center start">
  <div layout="row" layout-fill layout-padding layout-align="space-around center">
    <md-button hide-gt-sm class="md-raised" ng-click="showPortalSecondaryActionsBottomSheet(portal)">Ver acciones</md-button>

    <md-button aria-label="" class="md-raised md-warn" ng-click="savePortal()">Guardar cambios</md-button>
    <!--<md-button aria-label="" class="md-primary md-raised" ng-click="hidePortal()">Volver al listado</md-button>-->
  </div>
  <md-content flex layout-fill>
    <md-tabs flex layout-fill layout-padding md-selected="selectedIndex" class="minHeightMdTabsContent">
      <md-tab>
        <md-tab-label>Llaves</md-tab-label>
        <md-toolbar layout="row" layout-padding layout-align="space-around center">
          <md-input-container flex="60">
            <md-autocomplete
              md-selected-item="agentMatchData"
              md-search-text="agentcodenameQuery"
              md-search-text-change="agentMatchData=''"
              md-items="acitem in querySearchAgentes(agentcodenameQuery)"
              md-item-text="codeName"
              placeholder="codename">
              <span md-highlight-text="key.agent">{{acitem.codeName}}</span>
            </md-autocomplete>
          </md-input-container>
          <div layout="row" flex="40" layout-align="end center">
            <md-input-container flex>
              <input type="number" ng-model="amount">
            </md-input-container>
            <md-button flex aria-label="" class="md-accent md-fab md-mini" ng-click="addKey(portal, agentMatchData, amount); key = {}">+</md-button>
          </div>
        </md-toolbar>
        <h2 ng-hide="portal.keys.length > 0">Portal sin llaves</h2>
        <md-list flex>
          <md-item layout="column" ng-repeat="key in portal.keys | orderBy:'amount':true">
            <md-item-content>
              <div class="md-tile-content" layout="row" layout-padding layout-align="center center">
                <md-button class="md-primary" ng-href="/agents/{{key.agentId}}" flex="60">
                  <span style="font-style: italic;">{{key.agentId | agentCodeNameFromId:agents | normalizecodename}}</span>
                </md-button>
                <div layout="row" flex="40" layout-align="end center">
                  <md-input-container flex>
                    <input type="number" ng-model="key.amount">
                  </md-input-container>
                  <md-button aria-label="" class="md-warn md-fab md-mini" ng-click="deleteKey(portal, key); key = {}">
                    <span>X</span>
                  </md-button>
                </div>
              </div>
            </md-item-content>
          </md-item>
        </md-list>
      </md-tab>
      <md-tab>
        <md-tab-label>Etiquetas</md-tab-label>
        <div ng-include="'/partials/portal-labels.html'"></div>
      </md-tab>
      <md-tab label="Info">
        <div layout="column" layout-padding layout-align="start start">
          <md-button hide show-gt-sm ng-click="showPictures($event)" aria-label="{{portal.title}}">
            <img ng-src="{{portal.image}}" style="max-height:40px;max-width:40px;height:40px;" hide show-gt-sm>
          </md-button>
          <span>{{portal.address}}</span>
          <div layout layout-sm="column">
            <md-input-container flex>
              <label>Lat</label>
              <input required ng-model="portal.lat">
            </md-input-container>
            <md-input-container flex>
              <label>Lon</label>
              <input required ng-model="portal.lon">
            </md-input-container>
          </div>
          <md-input-container>
            <label>Telefonía Disponible</label>
            <textarea ng-model="portal.TelefoniaDisponible"></textarea>
          </md-input-container>
          <md-input-container>
            <label>Horarios</label>
            <textarea ng-model="portal.Horarios"></textarea>
          </md-input-container>
        </div>
      </md-tab>
      <md-tab label="Logística">
        <div layout="column" layout-padding layout-align="start start">
          <md-input-container>
            <label>Tipo de Recinto</label>
            <textarea ng-model="portal.TipoRecinto"></textarea>
          </md-input-container>
          <md-input-container>
            <label>Accesibilidad</label>
            <textarea ng-model="portal.Accesibilidad"></textarea>
          </md-input-container>
          <md-input-container>
            <label>Tips</label>
            <textarea ng-model="portal.Tips"></textarea>
          </md-input-container>
        </div>
      </md-tab>
      <md-tab label="SHARE">
        <div layout="column" layout-padding layout-align="start start">
          <md-input-container layout="row" layout-fill layout-align="start center">
            <div layout="column" layout-fill>
              <label>Google Maps</label>
              <input ng-model="portal.gmaps_url">
            </div>
            <md-button hide show-gt-md class="md-raised md-primary md-hue-2" ng-click="copyToClipboard(portal.gmaps_url);">Copy</md-button>
          </md-input-container>
          <md-input-container layout="row" layout-fill layout-align="start center">
            <div layout="column" layout-fill>
              <label>Ingress</label>
              <input ng-model="portal.ingress_url">
            </div>
            <md-button hide show-gt-md class="md-raised md-primary md-hue-2" ng-click="copyToClipboard(portal.ingress_url);">Copy</md-button>
          </md-input-container>
          <md-input-container layout="row" layout-fill layout-align="start center">
            <div layout="column" layout-fill>
              <label>Waze</label>
              <input ng-model="portal.waze_url">
            </div>
            <md-button hide show-gt-md class="md-raised md-primary md-hue-2" ng-click="copyToClipboard(portal.waze_url);">Copy</md-button>
          </md-input-container>
        </div>
      </md-tab>
      <md-tab hide show-gt-sm label="Mapa">
          <ui-gmap-google-map control="map.control" center="map.center" zoom="map.zoom" draggable="true" options="options" bounds="map.bounds" ng-if="portal">
          <ui-gmap-marker idKey="'marker.id'" coords="marker.coords" options="marker.options" >
            <ui-gmap-window show="'showPopup'">
              <div>{{marker.options.labelContent}}</div>
            </ui-gmap-window>
          </ui-gmap-marker>
          </ui-gmap-google-map>
      </md-tab>
    </md-tabs>
  </md-content>
</md-content>

